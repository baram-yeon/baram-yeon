window.UIRenderer=window.UIRenderer||function(){let e="수호",t=!1,n=!1,o=null,a=!1;function l(){document.querySelectorAll(".sub-tabs .tab").forEach((t=>{t.addEventListener("click",(function(){const n=t.getAttribute("data-category");e=n,c(e),window.BondCalculatorApp&&("function"==typeof window.BondCalculatorApp.showCategory&&window.BondCalculatorApp.showCategory(e,!1),"function"==typeof window.BondCalculatorApp.updateSelectedCount&&setTimeout((()=>window.BondCalculatorApp.updateSelectedCount(e)),50))}))}));const d=document.getElementById("influenceToggle");d?(d.addEventListener("change",(function(){document.querySelectorAll(".level25-indicator").forEach((e=>{e.style.opacity="0"})),t=d.checked,c(e,{selectMode:n,onSelect:o}),window.BondCalculatorApp&&setTimeout((()=>{"function"==typeof window.BondCalculatorApp.applySelectedState&&window.BondCalculatorApp.applySelectedState()}),100)})),d.checked=t):console.warn("Influence toggle switch not found in the DOM."),function(){const e=document.getElementById("helpBtn"),t=document.getElementById("helpTooltip"),n=document.getElementById("closeHelp");e&&t&&n&&(e.addEventListener("click",(e=>{e.stopPropagation(),t.style.display="block"===t.style.display?"none":"block"})),n.addEventListener("click",(()=>{t.style.display="none"})),document.addEventListener("click",(n=>{"block"!==t.style.display||t.contains(n.target)||e.contains(n.target)||(t.style.display="none")})))}(),window.addEventListener("resize",(function(){a||(clearTimeout(l.resizeTimer),l.resizeTimer=setTimeout(i,100))})),setTimeout(i,200)}function c(a,l={}){const c=e;e=a,void 0!==l.selectMode&&(n=l.selectMode),"function"==typeof l.onSelect&&(o=l.onSelect);const s=document.getElementById("imageContainer");s?(s.innerHTML="",document.querySelectorAll(".sub-tabs .tab").forEach((e=>{e.classList.remove("active"),e.getAttribute("data-category")===a&&e.classList.add("active")})),t?r(a,s):d(a,s),c!==a&&window.BondCalculatorApp&&"function"==typeof window.BondCalculatorApp.updateSelectedCount&&setTimeout((()=>window.BondCalculatorApp.updateSelectedCount(a)),0),setTimeout(i,50)):console.error("Image container not found!")}function i(){if(a)return;a=!0;const e=document.querySelectorAll(".img-box");let t=0;function n(e,t){const n=e.offsetWidth,o=Math.max(10,Math.min(Math.round(.08*n),20)),a=Math.max(6,Math.round(.6*o));t.style.width=o+"px",t.style.height=o+"px";const l=t.querySelector("span");l&&(l.style.fontSize=a+"px");const c=Math.max(3,Math.min(Math.round(.02*n),6));t.style.right=c+"px",t.style.bottom=c+"px",t.style.opacity="1"}e.forEach((e=>{const o=e.querySelector("img"),l=e.querySelector(".level25-indicator");o&&l&&(o.complete?n(o,l):(t++,o.onload=function(){n(o,l),t--,0===t&&(a=!1)}))})),0===t&&(a=!1)}function d(e,t){t.className="image-container-grid";const o=window.DataManager.getData(e);o&&Array.isArray(o)&&0!==o.length?(o.forEach((n=>{if(!n||!n.image||!n.name)return;const o=u(n,e);t.appendChild(o)})),n&&window.BondCalculatorApp&&"function"==typeof window.BondCalculatorApp.applySelectedState&&setTimeout((()=>window.BondCalculatorApp.applySelectedState()),50)):t.innerHTML=`<p>표시할 ${e} 환수 정보가 없습니다.</p>`}function r(e,t){t.className="image-container-grouped";const o=window.DataManager.getData(e);if(!o||!Array.isArray(o)||0===o.length)return void(t.innerHTML=`<p>표시할 ${e} 환수 정보가 없습니다.</p>`);const a=document.createElement("div");a.className="influence-row";let l=!1;["결의","고요","의지"].forEach((t=>{const n=s(e,t,o);n&&(a.appendChild(n),l=!0)})),l&&t.appendChild(a);const c=document.createElement("div");c.className="influence-row";let i=!1;["침착","냉정","활력"].forEach((t=>{const n=s(e,t,o);n&&(c.appendChild(n),i=!0)})),i&&t.appendChild(c),!l&&!i&&o.length>0?t.innerHTML=`<p>알려진 세력에 속하지 않는 ${e} 환수가 있습니다.</p>`:l||i||(t.innerHTML=`<p>표시할 ${e} 환수 정보가 없습니다.</p>`),n&&window.BondCalculatorApp&&"function"==typeof window.BondCalculatorApp.applySelectedState&&setTimeout((()=>window.BondCalculatorApp.applySelectedState()),100)}function s(e,t,n){if(!window.DataManager.FACTION_ICONS)return console.error("FACTION_ICONS is not available!"),null;const o=n.filter((e=>e&&e.influence===t));if(0===o.length)return null;const a=document.createElement("div");a.className="influence-group";const l=document.createElement("div");l.className="header-wrapper";const c=document.createElement("img"),i=window.DataManager.FACTION_ICONS[t];i?(c.src=i,c.alt=`${t} 아이콘`,c.className="influence-icon",l.appendChild(c)):console.warn(`Icon not found for influence: ${t}.`);const d=document.createElement("h3");d.className="influence-header",d.textContent=t;const r=document.createElement("span");r.className="influence-count",r.textContent=` (${o.length})`,d.appendChild(r),l.appendChild(d),a.appendChild(l);const s=document.createElement("div");return s.className="influence-items",o.forEach((t=>{if(!t||!t.image||!t.name)return;const n=u(t,e);s.appendChild(n)})),a.appendChild(s),a}function u(e,t){const a=document.createElement("div");a.className="img-wrapper";const l=document.createElement("div");l.className="img-box",a.appendChild(l);const{hasFullRegistration:c,hasFullBind:i}=window.DataManager.checkSpiritStats(e);if(c){const e=document.createElement("div");e.className="ribbon-left",e.innerHTML="<span>R</span>",e.title="등록 효과 전체 보유",l.appendChild(e)}if(i){const e=document.createElement("div");e.className="ribbon-right",e.innerHTML="<span>B</span>",e.title="결속 효과 전체 보유",l.appendChild(e)}const d=document.createElement("img");if(d.src=e.image,d.alt=e.name,d.title=e.name,d.loading="lazy",d.dataset.category=t,d.dataset.image=e.image,d.dataset.influence=e.influence||"",l.appendChild(d),window.DataManager.hasLevel25BindStats(e)){const e=document.createElement("div");e.className="level25-indicator",e.innerHTML="<span>25</span>",e.title="25레벨 결속 효과 보유",e.style.opacity="0",l.appendChild(e)}n&&o?(l.addEventListener("click",(function(){o(e,t)})),l.style.cursor="pointer"):(l.addEventListener("click",(function(){window.ModalHandler&&window.ModalHandler.showInfo(t,e.image,e.influence)})),l.style.cursor="pointer");const r=document.createElement("small");return r.className="img-name",r.textContent=e.name,a.appendChild(r),a}return l.resizeTimer=null,{initUIEvents:l,showCategory:c,displayAllPets:d,displayPetsByInfluence:r,createInfluenceGroup:s,setSelectionMode:function(t,a){return n=!0===t,o="function"==typeof a?a:null,c(e,{selectMode:n,onSelect:o}),n},getCurrentCategory:function(){return e},adjustIndicatorSize:i}}();